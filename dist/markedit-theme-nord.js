"use strict";const V=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),E=require("@codemirror/view"),b=require("@codemirror/language"),p=(n,c={})=>n??c,W=p(m.MarkEdit.userSettings),T=p(W["extension.markeditTheming"]),z=T.enabledMode??"both",P=p(T.lightTheme),L=p(T.darkTheme),q=n=>["both",n?"dark":"light"].includes(z),D=_(P),U=_(L,{dark:!0});function K(n,c){if(!q(n))return c;const e=n?U:D;return e===void 0?c:[e,c].filter(a=>a!==void 0)}function J(n,c){if(!q(n))return c;const e=n?L.custom:P.custom;return e===void 0?c:{...c,...e}}function _(n,c){const e={},a=[],r=n.editor,o=n.highlight;return r?.textColor&&(e["&"]??={},e["&"].color=r?.textColor,e[".cm-activeLineGutter"]={backgroundColor:r?.textColor}),r?.backgroundColor&&(e["&"]??={},e["&"].backgroundColor=r?.backgroundColor),r?.activeLineBackground&&(e[".cm-activeLine"]={backgroundColor:r?.activeLineBackground}),r?.caretColor&&(e[".cm-content"]={caretColor:r?.caretColor},e[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r?.caretColor}),r?.selectionBackground&&(e["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:r?.selectionBackground}),r?.matchingBracketBackground&&(e["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:r?.matchingBracketBackground}),r?.gutterText&&(e[".cm-gutters"]??={},e[".cm-gutters"].color=r?.gutterText),r?.gutterBackground&&(e[".cm-gutters"]??={},e[".cm-gutters"].backgroundColor=r?.gutterBackground,e[".cm-gutters"].border="none"),r?.foldPlaceholderText&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].color=r?.foldPlaceholderText),r?.foldPlaceholderBackground&&(e[".cm-foldPlaceholder"]??={},e[".cm-foldPlaceholder"].backgroundColor=r?.foldPlaceholderBackground,e[".cm-foldPlaceholder"].border="none"),r?.searchMatchBackground&&(e[".cm-searchMatch"]={backgroundColor:r?.searchMatchBackground}),r?.selectionMatchBackground&&(e[".cm-selectionMatch"]={backgroundColor:r?.selectionMatchBackground}),o?.heading&&a.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&a.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&a.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&a.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&a.push({tag:t.tags.quote,color:o?.quote}),o?.link&&a.push({tag:t.tags.link,color:o?.link}),o?.separator&&a.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&a.push({tag:[t.tags.meta,t.tags.comment],color:o?.comment}),o?.meta&&a.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&a.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&a.push({tag:[t.tags.atom,t.tags.bool,t.tags.url,t.tags.contentSeparator,t.tags.labelName],color:o?.atom}),o?.literal&&a.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&a.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&a.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&a.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&a.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&a.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&a.push({tag:t.tags.className,color:o?.class}),o?.macro&&a.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&a.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&a.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&a.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&a.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&a.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&a.push({tag:t.tags.invalid,color:o?.invalid}),[E.EditorView.theme(e,c),b.syntaxHighlighting(b.HighlightStyle.define(a))]}const s={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Q=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.lineGutter} {}
${s.foldGutter} {}
${s.visibleSpace} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.emphasisElement} {}
${s.accentColor} {}
${s.syntaxMarker} {}
`,$=window,X=$.__extractStyleRules__??(n=>n.value?.rules),Y=$.__extractHighlightSpecs__??(n=>n.value?.specs);function Z(n){const c=document.createElement("style");return c.textContent=n,document.head.appendChild(c),c}function tt(n){if(n===void 0)return[{},[]];const c=ot(n);return[Object.fromEntries(c.flatMap(a=>{const r=X(a)?.join(`
`)??"";return Object.entries(at(r))})),c.flatMap(a=>Y(a)??[])]}function F(n,c){return n.find(e=>!!(e.tag.toString().includes(c.toString())&&e.color!==void 0))?.color}function B(n,c,e){for(const[a,r]of Object.entries(n))if(a.includes(c)&&(e===void 0||!a.includes(e))){const o=r.background??r.backgroundColor;if(o!==void 0)return o}}function et(n){const c=n.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(c===null)return;const[e,a,r]=c.slice(1,4).map(Number);return`rgba(${e}, ${a}, ${r}, 0.6)`}function ot(n){const c=[],e=[n];for(;e.length>0;){const a=e.pop();Array.isArray(a)?a.forEach(r=>e.push(r)):"extension"in a?e.push(a.extension):c.push(a)}return c}function at(n){const c={},e=new CSSStyleSheet;e.replaceSync(n);for(const a of e.cssRules){const{style:r,selectorText:o}=a,{background:g,backgroundColor:d}=r;c[o]={},g.length>0&&(c[o].background=g),d.length>0&&(c[o].backgroundColor=d)}return c}function rt(n){n.light!==void 0&&(i().customThemes.light=n.light),n.dark!==void 0&&(i().customThemes.dark=n.dark),typeof m.MarkEdit.editorView=="object"&&x(m.MarkEdit.editorView)}const k=window,i=()=>k.__markeditTheming__,O=matchMedia("(prefers-color-scheme: dark)");typeof i()!="object"&&ct();function ct(){k.__markeditTheming__={styleSheet:Z(Q),configurator:new V.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(i().configurator.of([])),m.MarkEdit.onEditorReady(c=>x(c));const n=()=>setTimeout(()=>x(m.MarkEdit.editorView),15);O.addEventListener("change",n),i().mainThemeName=k.config.theme,Object.defineProperty(k.config,"theme",{get(){return i().mainThemeName},set(c){i().mainThemeName=c,n()}})}function x(n){const c=O.matches,e=c?i().customThemes.dark:i().customThemes.light,a=K(c,e?.extension),r=J(c,e?.colors);n.dispatch({effects:i().configurator.reconfigure(a??[])});const[o,g]=tt(a),d=a===void 0;i().styleSheet.disabled=d,nt(n,c,d,o,g,r)}function nt(n,c,e,a,r,o){const g=B(a,".cm-activeLine",".cm-activeLineGutter"),d=B(a,s.selectionBackground),v=B(a,s.matchingBracket),h=getComputedStyle(n.contentDOM).color,M=o?.visibleSpace??et(h),G=F(r,t.tags.heading)!==void 0,H=F(r,t.tags.processingInstruction),I=[[s.activeIndicator,g,"background"],[s.matchingBracket,v,"background"],[s.lineGutter,h,"color"],[s.foldGutter,M,"color"],[s.visibleSpace,M,"color"],[s.accentColor,o?.accentColor,"color"],[s.syntaxMarker,H??o?.syntaxMarker,"color"]],R=Array.from(document.querySelectorAll("style")),f=c?i().darkOriginalRules:i().lightOriginalRules;for(const j of R){const y=j.sheet?.cssRules;if(y!==void 0)for(let C=0;C<y.length;++C){const l=y[C],u=l.selectorText??"";u.includes(".cm-focused")&&u.includes(s.selectionBackground)&&(f.selectionBackground??=l.cssText,e?l.cssText=f.selectionBackground:d!==void 0&&l.style.setProperty("background",d,"important")),G&&(u===".cm-md-header"||u===".cm-md-header:not(.cm-md-quote)")&&(f.markdownHeader??=l.cssText,e?l.cssText=f.markdownHeader:l.style.removeProperty("color"));for(const[A,N,w]of I)u===A&&(N===void 0?l.style.removeProperty(w):(l.style.setProperty(w,N,"important"),(u===s.matchingBracket||u===s.activeIndicator)&&l.style.setProperty("box-shadow","unset","important")));u===s.emphasisElement&&(o?.subtleEmphasis??!0?l.style.setProperty("color","inherit","important"):l.style.removeProperty("color"))}}}function S(){return S=Object.assign?Object.assign.bind():function(n){for(var c=1;c<arguments.length;c++){var e=arguments[c];for(var a in e)({}).hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n},S.apply(null,arguments)}var st=n=>{var{theme:c,settings:e={},styles:a=[]}=n,r={".cm-gutters":{}},o={};e.background&&(o.backgroundColor=e.background),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),e.foreground&&(o.color=e.foreground),e.fontSize&&(o.fontSize=e.fontSize),(e.background||e.foreground)&&(r["&"]=o),e.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:e.fontFamily}),e.gutterBackground&&(r[".cm-gutters"].backgroundColor=e.gutterBackground),e.gutterForeground&&(r[".cm-gutters"].color=e.gutterForeground),e.gutterBorder&&(r[".cm-gutters"].borderRightColor=e.gutterBorder),e.caret&&(r[".cm-content"]={caretColor:e.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:e.caret});var g={};e.gutterActiveForeground&&(g.color=e.gutterActiveForeground),e.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:e.lineHighlight},g.backgroundColor=e.lineHighlight),r[".cm-activeLineGutter"]=g,e.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:e.selection+" !important"}),e.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:e.selectionMatch});var d=E.EditorView.theme(r,{dark:c==="dark"}),v=b.HighlightStyle.define(a),h=[d,b.syntaxHighlighting(v)];return h},it={background:"#2e3440",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#00000073",selectionMatch:"#00000073",gutterBackground:"#2e3440",gutterForeground:"#4c566a",gutterActiveForeground:"#d8dee9",lineHighlight:"#4c566a29"},lt=[{tag:t.tags.keyword,color:"#5e81ac"},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:"#88c0d0"},{tag:[t.tags.variableName],color:"#8fbcbb"},{tag:[t.tags.function(t.tags.variableName)],color:"#8fbcbb"},{tag:[t.tags.labelName],color:"#81a1c1"},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:"#5e81ac"},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:"#a3be8c"},{tag:[t.tags.brace],color:"#8fbcbb"},{tag:[t.tags.annotation],color:"#d30102"},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:"#b48ead"},{tag:[t.tags.typeName,t.tags.className],color:"#ebcb8b"},{tag:[t.tags.operator,t.tags.operatorKeyword],color:"#a3be8c"},{tag:[t.tags.tagName],color:"#b48ead"},{tag:[t.tags.squareBracket],color:"#bf616a"},{tag:[t.tags.angleBracket],color:"#d08770"},{tag:[t.tags.attributeName],color:"#ebcb8b"},{tag:[t.tags.regexp],color:"#5e81ac"},{tag:[t.tags.quote],color:"#b48ead"},{tag:[t.tags.string],color:"#a3be8c"},{tag:t.tags.link,color:"#a3be8c",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:"#8fbcbb"},{tag:[t.tags.meta],color:"#88c0d0"},{tag:[t.tags.monospace],color:"#d8dee9",fontStyle:"italic"},{tag:[t.tags.comment],color:"#4c566a",fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:"#5e81ac"},{tag:t.tags.emphasis,fontStyle:"italic",color:"#5e81ac"},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:"#5e81ac"},{tag:t.tags.special(t.tags.heading1),fontWeight:"bold",color:"#5e81ac"},{tag:t.tags.heading1,fontWeight:"bold",color:"#5e81ac"},{tag:[t.tags.heading2,t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:"#5e81ac"},{tag:[t.tags.heading5,t.tags.heading6],color:"#5e81ac"},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:"#d08770"},{tag:[t.tags.processingInstruction,t.tags.inserted],color:"#8fbcbb"},{tag:[t.tags.contentSeparator],color:"#ebcb8b"},{tag:t.tags.invalid,color:"#434c5e",borderBottom:"1px dotted #d30102"}],gt=n=>{var{theme:c="dark",settings:e={},styles:a=[]}={};return st({theme:c,settings:S({},it,e),styles:[...lt,...a]})},dt=gt();rt({dark:{extension:dt}});
