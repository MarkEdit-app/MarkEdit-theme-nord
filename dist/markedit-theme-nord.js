"use strict";const dt=require("@codemirror/state"),t=require("@lezer/highlight"),p=require("markedit-api"),F=require("@codemirror/view"),B=require("@codemirror/language"),M=(o,s={})=>o??s,ut=M(p.MarkEdit.userSettings),G=z("extension.markeditTheming"),mt=T(!1)?M(G.lightTheme):void 0,ht=T(!0)?M(G.darkTheme):void 0;function z(o){return o===void 0?{}:M(ut[o])}function J(o){return o.enabledMode??"both"}function T(o,s=J(G)){return["both",o?"dark":"light"].includes(s)}function ft(o,s,c){const a=bt({lhs:c,rhs:o?ht:mt});return{extensions:[...o?A(a,{dark:!0}):A(a),s].filter(e=>e!==void 0),colors:a}}function A(o,s){const c={},a=[],r=o.editor,e=o.highlight;r?.textColor&&(c["&"]??={},c["&"].color=r?.textColor,c[".cm-activeLineGutter"]={backgroundColor:r?.textColor}),r?.backgroundColor&&(c["&"]??={},c["&"].backgroundColor=r?.backgroundColor),r?.activeLineBackground&&(c[".cm-activeLine"]={backgroundColor:r?.activeLineBackground}),r?.caretColor&&(c[".cm-content"]={caretColor:r?.caretColor},c[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r?.caretColor}),r?.selectionBackground&&(c["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:r?.selectionBackground}),r?.matchingBracketBackground&&(c["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:r?.matchingBracketBackground}),r?.gutterText&&(c[".cm-gutters"]??={},c[".cm-gutters"].color=r?.gutterText),r?.gutterBackground&&(c[".cm-gutters"]??={},c[".cm-gutters"].backgroundColor=r?.gutterBackground,c[".cm-gutters"].border="none"),r?.foldPlaceholderText&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].color=r?.foldPlaceholderText),r?.foldPlaceholderBackground&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].backgroundColor=r?.foldPlaceholderBackground,c[".cm-foldPlaceholder"].border="none"),r?.searchMatchBackground&&(c[".cm-searchMatch"]={backgroundColor:r?.searchMatchBackground}),r?.selectionMatchBackground&&(c[".cm-selectionMatch"]={backgroundColor:r?.selectionMatchBackground}),e?.heading&&a.push({tag:t.tags.heading,color:e?.heading}),e?.bold&&a.push({tag:t.tags.strong,color:e?.bold}),e?.italic&&a.push({tag:t.tags.emphasis,color:e?.italic}),e?.strikethrough&&a.push({tag:t.tags.strikethrough,color:e?.strikethrough}),e?.quote&&a.push({tag:t.tags.quote,color:e?.quote}),e?.link&&a.push({tag:[t.tags.url,t.tags.link],color:e?.link}),e?.divider&&a.push({tag:t.tags.contentSeparator,color:e?.divider}),e?.comment&&a.push({tag:t.tags.comment,color:e?.comment}),e?.meta&&a.push({tag:t.tags.meta,color:e?.meta}),e?.keyword&&a.push({tag:t.tags.keyword,color:e?.keyword}),e?.atom&&a.push({tag:[t.tags.atom,t.tags.bool],color:e?.atom}),e?.literal&&a.push({tag:[t.tags.literal,t.tags.inserted],color:e?.literal}),e?.string&&a.push({tag:[t.tags.string,t.tags.deleted],color:e?.string}),e?.special&&a.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:e?.special}),e?.variable&&a.push({tag:t.tags.definition(t.tags.variableName),color:e?.variable}),e?.local&&a.push({tag:t.tags.local(t.tags.variableName),color:e?.local}),e?.type&&a.push({tag:[t.tags.typeName,t.tags.namespace],color:e?.type}),e?.class&&a.push({tag:t.tags.className,color:e?.class}),e?.macro&&a.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:e?.macro}),e?.property&&a.push({tag:t.tags.definition(t.tags.propertyName),color:e?.property}),e?.label&&a.push({tag:t.tags.labelName,color:e?.label}),e?.operator&&a.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:e?.operator}),e?.constant&&a.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:e?.constant}),e?.instruction&&a.push({tag:[t.tags.separator,t.tags.processingInstruction,t.tags.definition(t.tags.name)],color:e?.instruction}),e?.invalid&&a.push({tag:t.tags.invalid,color:e?.invalid});const l=[];return Object.keys(c).length>0&&l.push(F.EditorView.theme(c,s)),a.length>0&&l.push(B.syntaxHighlighting(B.HighlightStyle.define(a))),l}function bt(o){return{editor:{...o.lhs?.editor,...o.rhs?.editor},highlight:{...o.lhs?.highlight,...o.rhs?.highlight},subtleEmphasis:o.rhs?.subtleEmphasis??o.lhs?.subtleEmphasis}}const n={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark, .cm-md-bold.tok-meta, .cm-md-italic.tok-meta, .cm-md-strikethrough.tok-meta",boldText:".cm-md-bold:not(.tok-meta)",italicText:".cm-md-italic:not(.tok-meta)",quoteText:".cm-md-quote:not(.cm-md-quoteMark)",dividerColor:".cm-md-horizontalRule"},pt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${n.lineGutter} {}
${n.foldGutter} {}
${n.visibleSpace} {}
${n.matchingBracket} {}
${n.activeIndicator} {}
${n.accentColor} {}
${n.syntaxMarker} {}
${n.boldText} {}
${n.italicText} {}
${n.quoteText} {}
${n.dividerColor} {}
`,Q=window,kt=Q.__extractStyleRules__??(o=>o.value?.rules),Ct=Q.__extractHighlightSpecs__??(o=>o.value?.specs);function vt(o){const s=document.createElement("style");return s.textContent=o,document.head.appendChild(s),s}function yt(o){if(o.length===0)return[{},[]];const s=_(o);return[Object.fromEntries(s.flatMap(a=>{const r=kt(a)?.join(`
`)??"";return Object.entries(Bt(r))})),s.flatMap(a=>Ct(a)??[])]}function b(o,s,c){return o.find(a=>!!(a.tag.toString().includes(s.toString())&&a.color!==void 0))?.color??c}function q(o,s,c){for(const[a,r]of Object.entries(o))if(a.includes(s)&&(c===void 0||!a.includes(c))){const e=r.background??r.backgroundColor;if(e!==void 0)return e}}function xt(o){const s=o.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(s===null)return;const[c,a,r]=s.slice(1,4).map(Number);return`rgba(${c}, ${a}, ${r}, 0.6)`}function X(o){const s=r=>r!==null&&typeof r=="object";if(!s(o))return!0;const c=Object.entries(o),a=r=>r!=null;for(const[,r]of c)if(s(r)){if(!X(r))return!1}else if(a(r))return!1;return!0}function _(o){return Array.isArray(o)?o.flatMap(_):"extension"in o?_(o.extension):[o]}function Bt(o){const s={},c=new CSSStyleSheet;c.replaceSync(o);for(const a of c.cssRules){const{style:r,selectorText:e}=a,{background:l,backgroundColor:u}=r;s[e]={},l.length>0&&(s[e].background=l),u.length>0&&(s[e].backgroundColor=u)}return s}function Tt(o){const s=o.options?.settingsKey,c=J(z(s));o.light!==void 0&&T(!1,c)&&(i().customThemes.light=o.light),o.dark!==void 0&&T(!0,c)&&(i().customThemes.dark=o.dark),typeof p.MarkEdit.editorView=="object"&&O(p.MarkEdit.editorView)}const x=window,i=()=>x.__markeditTheming__,Y=matchMedia("(prefers-color-scheme: dark)");typeof i()!="object"&&Mt();function Mt(){x.__markeditTheming__={styleSheet:vt(pt),configurator:new dt.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},p.MarkEdit.addExtension(i().configurator.of([])),p.MarkEdit.onEditorReady(s=>O(s));const o=()=>setTimeout(()=>O(p.MarkEdit.editorView),15);Y.addEventListener("change",o),i().mainThemeName=x.config.theme,Object.defineProperty(x.config,"theme",{get(){return i().mainThemeName},set(s){i().mainThemeName=s,o()}})}function O(o){const s=Y.matches,c=s?i().customThemes.dark:i().customThemes.light,{extensions:a,colors:r}=ft(s,c?.extension,c?.colors);o.dispatch({effects:i().configurator.reconfigure(a)});const[e,l]=yt(a),u=a.length===0&&X(r);i().styleSheet.disabled=u,St(o,s,u,e,l,r)}function St(o,s,c,a,r,e){const l=q(a,".cm-activeLine",".cm-activeLineGutter"),u=q(a,n.selectionBackground),et=q(a,n.matchingBracket),S=getComputedStyle(o.contentDOM).color,R=e.editor?.visibleSpaceColor??xt(S),f=e.subtleEmphasis===!0?S:void 0,H=b(r,t.tags.heading,f),ot=b(r,t.tags.processingInstruction,f),rt=b(r,t.tags.strong,f),at=b(r,t.tags.emphasis,f),ct=b(r,t.tags.quote,f),st=b(r,t.tags.contentSeparator,f),nt=[[n.activeIndicator,l,"background"],[n.matchingBracket,et,"background"],[n.lineGutter,S,"color"],[n.foldGutter,R,"color"],[n.visibleSpace,R,"color"],[n.accentColor,H,"color"],[n.syntaxMarker,ot,"color"],[n.boldText,rt,"color"],[n.italicText,at,"color"],[n.quoteText,ct,"color"],[n.dividerColor,st,"color"]],it=Array.from(document.querySelectorAll("style")),v=s?i().darkOriginalRules:i().lightOriginalRules;for(const lt of it){const w=lt.sheet?.cssRules;if(w!==void 0)for(let N=0;N<w.length;++N){const g=w[N],m=g.selectorText??"";m.includes(".cm-focused")&&m.includes(n.selectionBackground)&&(v.selectionBackground??=g.cssText,c?g.cssText=v.selectionBackground:u!==void 0&&g.style.setProperty("background",u,"important")),H!==void 0&&(m===".cm-md-header"||m===".cm-md-header:not(.cm-md-quote)")&&(v.markdownHeader??=g.cssText,c?g.cssText=v.markdownHeader:g.style.removeProperty("color"));for(const[gt,I,V]of nt)m===gt&&(I===void 0?g.style.removeProperty(V):(g.style.setProperty(V,I,"important"),(m===n.matchingBracket||m===n.activeIndicator)&&g.style.setProperty("box-shadow","unset","important")))}}}const j="#2e3440",Z="#3b4252",tt="#434c5e",k="#4c566a",C="#d8dee9",wt="#e5e9f0",Nt="#eceff4",h="#8fbcbb",W="#88c0d0",qt="#81a1c1",d="#5e81ac",$t="#bf616a",D="#d08770",$="#ebcb8b",y="#a3be8c",E="#b48ead",K="#d30102",Et="#252a33",P=k,Pt=j,L=Z,Lt=k,U=C,_t=F.EditorView.theme({"&":{color:C,backgroundColor:Pt},".cm-content":{caretColor:U},".cm-cursor, .cm-dropCursor":{borderLeftColor:U},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Lt},".cm-panels":{backgroundColor:Et,color:k},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"transparent",outline:`1px solid ${h}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:C,color:j},".cm-activeLine":{backgroundColor:P},".cm-selectionMatch":{backgroundColor:wt,color:Z},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${h}`},"&.cm-focused .cm-matchingBracket":{backgroundColor:Nt,color:tt},".cm-gutters":{backgroundColor:j,color:k,border:"none"},".cm-activeLineGutter":{backgroundColor:P,color:C},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:L},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:L,borderBottomColor:L},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:P,color:k}}},{dark:!0}),Ot=B.HighlightStyle.define([{tag:t.tags.keyword,color:d},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:W},{tag:[t.tags.variableName],color:h},{tag:[t.tags.function(t.tags.variableName)],color:h},{tag:[t.tags.labelName],color:qt},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:d},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:y},{tag:[t.tags.brace],color:h},{tag:[t.tags.annotation],color:K},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:E},{tag:[t.tags.typeName,t.tags.className],color:$},{tag:[t.tags.operator,t.tags.operatorKeyword],color:y},{tag:[t.tags.tagName],color:E},{tag:[t.tags.squareBracket],color:$t},{tag:[t.tags.angleBracket],color:D},{tag:[t.tags.attributeName],color:$},{tag:[t.tags.regexp],color:d},{tag:[t.tags.quote],color:E},{tag:[t.tags.string],color:y},{tag:t.tags.link,color:y,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:h},{tag:[t.tags.meta],color:W},{tag:[t.tags.monospace],color:C,fontStyle:"italic"},{tag:[t.tags.comment],color:k,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:d},{tag:t.tags.emphasis,fontStyle:"italic",color:d},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:d},{tag:t.tags.special(t.tags.heading1),fontWeight:"bold",color:d},{tag:t.tags.heading1,fontWeight:"bold",color:d},{tag:[t.tags.heading2,t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:d},{tag:[t.tags.heading5,t.tags.heading6],color:d},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:D},{tag:[t.tags.processingInstruction,t.tags.inserted],color:h},{tag:[t.tags.contentSeparator],color:$},{tag:t.tags.invalid,color:tt,borderBottom:`1px dotted ${K}`}]),jt=[_t,B.syntaxHighlighting(Ot)];Tt({dark:{extension:jt}});
